## 登录设计思考

1. 使用jsonwebtoken生成token

2. 将token下发给客户端，客户端放进localsotrage中,每次请求接口时带上。
    - 为什么不用cookie？由于cookie会被浏览器自动带上，攻击者可以进行CSRF攻击，在恶意网站利用form、scrpit、img等可以跨域标签来制造请求，此时这些请求会带上cookie，这样就冒用了用户凭证，所以不放在cookie里。
    - 当然还是有其他方式可以导致Token泄漏，比如XSS，请求劫持等，但是这些都是其他方面的安全漏洞。直接针对这些场景做好防范即可。期房防范如下：
    - XSS防范: 1. 针对输入和输出都做好转义，不要相信用户的输入，对于输出，也要做好转义，比如在前端输出时，对于用户输入的内容，要做好转义，比如将`<`转义为`&lt;`，`>`转义为`&gt;`，这样就可以防止XSS攻击了。 2. 可以给html文件的响应头设置CSP
      - 攻击过程：都是要把恶意代码提交给服务器，要不被服务器执行，要不恶意代码被浏览器执行。恶意代码是获取用户信息，然后发送请求给攻击者服务器，这样攻击者就可以拿到用户信息了。
    - Token泄漏: 这个暂时没研究办法。 to do 
        - 网略被监听
    - 资料：CSRF(Cross-Site Request Forgery)跨站请求伪造; XSS(Cross Site Scripting)跨站脚本攻击

3. 服务端验证token，按时效和合法性来验证，过期就创造一个新的，不合法就返回401。如果过期48小时，就需要重新登录。
    - 为了防止token泄漏，可以设置token的过期时间，这样即使token泄漏，也只能在一定时间内使用，过期后就失效了。增加持续攻击的难度。
    - 过期48小时重新登录，是因为token泄漏的话，只能触发用户行为来重新获取登录态，增加持续攻击的难度。
